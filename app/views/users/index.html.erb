<body>
  <div id="wrapper">
  <%= render 'layouts/sidebar' %>
  <div id="container">
    <section class="section" id="section4">
      <div class="container-fluid">
        <div class="row-fluid">
          <div class="span4">
            <h2>Users</h2>
            <h5>Download: <%= link_to "Excel", users_path(format: "xls"), {:style=>'color:#151515;'} %></h5>
            <h5>Total Attending: <%= @users.sum('rsvp_count') %></h5>
          </div><!-- /span3 -->
        </div><!-- /row-fluid -->   
        <div class="span8">
          <table class="table table-condensed">
            <thead>
              <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Registered</th>
                <th>Role</th>
                <th></th>
                <th>#</th>
                <th></th>
                <th>RSVP</th>
                <th></th>
                <th></th>
              </tr>
            </thead>
          <tbody>
          <% @users.each do |user| %>
            <tr>
              <td><%= user.full_name %></td>
              <td><%= user.email %></td>
              <td><%= user.created_at.to_date %></td>
              <td><%= user.roles.join(', ').titleize unless user.roles.first.nil? %></td>
              <td></td>
              <td><%= user.rsvp_count %></td>
              <td>
              <% if user.rsvp_confirmation == 1 %>
                              <td>Attending</td>
                            <% end %>
                            <% if user.rsvp_confirmation == 0 %>
                              <td>Not Attending</td>
                            <% end %>
                            <% if user.rsvp_confirmation == 2 %>
                              <td>Undecided</td>
                            <% end %>
                          </td>
              <td>
              <a data-toggle="modal" href="#role-options-<%= user.id %>" class="btn btn-mini btn-primary" type="button">Change role</a>
              <%= render user %>
              </td>
              <td><%= link_to("Delete user", user_path(user), :data => { :confirm => "Are you sure?" }, :method => :delete, :class => 'btn btn-mini btn-danger') unless user == current_user %></td>
              <td><%= simple_form_for resource, :as => resource_name, :url => invitation_path(resource_name), :html => {:method => :post} do |f| %>
                      <%= devise_error_messages! %>
                    <% resource.class.invite_key_fields.each do |field| -%>
                      <%= f.input field, :input_html => { :value => user.email }, :as => :hidden %>
                    <% end -%>
                    <%= f.button :submit, 'Resend invite', :class => 'btn btn-mini btn-warning' unless user == current_user %>
                    <% end %></td>
              </tr>
            <% end %>
              </tbody>
          </table>
        </div><!-- /span -->
      </div><!-- /container -->
    </section>
    </div> 
  </div><!-- /wrapper -->
</body>